<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
	
    <link href="css/mui.min.css" rel="stylesheet"/>
   <style>
	   .ding1{
		   width:100%;
		   height:2.5rem;
		   background:#007AFF;
		   position: relative;
	   }
	   .cp1{
		   position: absolute;
		   width:145px;
		   font-size:1.3rem;
		   color:#fff;
		   left:35%;
		   top:25%;
		   overflow: hidden;
			text-overflow: clip;
			white-space: nowrap;
			text-overflow: ellipsis;
	   }
	   .cp2{
		   position:absolute;
		   color:#fff;
		   left:78%;
		   top:25%;
		   font-size:1rem;
	   }
	   /* 搜索 */
	   *{
	   		border:0;
	   		padding:0;
	   		margin:0;
	   	}
	   	#title{
	   		background-color:#3190E8;
	   		/* color:white; */
	   	}
	   	#title h1{
	   		color:white;
	   		font-size:21px;
	   	}
		li{
			list-style: none;
		}
	   	/* 搜索框 */
	   	.search_box{
	   		width: 100%;
	   		padding:2%;
	   	}
	   	.search_box .search{
	   		width:75%;
	   		height:40px;
	   		margin-right:1%;
	   		font-weight:800;
	   	}
	   	.search_box button{
	   		width: 22%;
	   		height:40px;
	   		background-color:#3190E8;
	   		color:white;
	   	}
	   	/* 搜索历史 */
	   	.search_history{
	   		width:100%;
	   		padding:2%;
	   		color:#757575;
	   		/* height:100px; */
	   	}
	   	.search_history .history_list{
	   		background:white;
	   		/* height:200px; */
	   		/* border:1px solid pink; */
	   	}
	   	
	   	.search_history .history_list li{
	   		height:40px;
	   		padding:1%;
	   		line-height: 40px;
	   		border-bottom:1px solid lightgray;
	   	}
		/* x */
		.search_history .history_list .x{
			position: absolute;
			right:4%;
			line-height: 40px;
		}
	    /* 清空历史搜索 */
	    .search_history .history_list .emptylishi{
			text-align: center;
			color:#3190E8;
			height:45px;
			line-height: 45px;
	    }
		.search_history .history_list .clear{
			/* height:0; */
			background-color:lightgray;
		}
		/* 商家 */
		.business{
			width:100%;
			padding:0 2%;
		}
		.business h4{
			color: #757575;
			width:100%;
			height:20px;
			/* background-color:pink; */
		}
		.business_list li{
			background-color:white;
			margin-top:-1%;
			/* height:75px; */
			border-bottom:1px solid lightgray;
		}
		.business_list span{
			font-size:14px;
		}
		.business_list li .goodsimg{
			margin:0 3%;
			width:15%;
			float:left;
		}
		.business_list li .goodsimg img{
			width:100%;
		}
		/* 订单 */
		/* 选取地址 */
		.address{
			width:100%;
			height:100px;
			background-color:white;
			margin-bottom: 2%;
			/* background: url(images/xiazai.png) 0 100% repeat-x; */
		}
		.address .select_add{
			width:100%;
			padding:0 3%;
			margin:0 auto;
			height:100px;
			line-height: 100px;
			background-color:transparent;
			background: url(img/xiazai.png) 0 100% repeat-x;
		}
		.select_add img{
			width:7%;
		}
		.select_add img.add2{
			width:7%;
			position:absolute;
			right:5%;
			top:12%;
		}
		/* 送达时间 */
		.Service_time{
			width:100%;
			height:100px;
			background-color:white;
			border-left:5px solid #3190E8;
			margin-bottom:2%;
		}
		.Service_time .time{
			width:90%;
			height:100px;
			margin:0 auto;
			/* background-color:pink; */
		}
		.time .time_left{
			float:left;
			width:100px;
			line-height: 100px;
		}
		.time .time_left b{
			font-size:20px;
		}
		.time .time_rig{
			float:right;
			margin-top:5%;
			/* text-align: right; */
		}
		.time .time_rig .p1{
			font-size:16px;
			color:#3190E8;
		}
		.time_rig .p2{
			width:60px;
			height:30px;
			border-radius: 8px;
			background-color:#3190E8;
			color:white;
			text-align: center;
			line-height: 30px;	
		}
		/* 支付方式 */
		.payment{
			background:white;
			height:90px;
			margin-bottom:2%;
		}
		.payment li{
			width:100%;
			height:45px;
			line-height: 45px;
			padding:0 2%;
			border-bottom:1px solid #F5F5F5;
			position: relative;
		}
		.payment li span.pay{
			/* float:right; */
			/* width:90px; */
			position: absolute;
			right:8%;
		}
		.payment li img{
			width:7%;
			position: absolute;
			right:0;
			top:20%;
		}
		/* 订单商户商品 */
		.business{
			width:100%;
			height:70px;
			background:white;
			padding:4%;
			position: relative;
			margin-bottom:1px solid pink;
		}
		.business img{
			width:12%;
			line-height:60px;
		}
		.business span{
			/* margin-top:-10px; */
			position:absolute;
			top:35%;
			font-size:20px;
			margin-left:2%;
		}
		/* 商品列表 */
		.wares{
			width:100%;
			/* height:100px; */
			background:white;
			padding:3%;
			border-bottom:1px solid #F5F5F5;
		}
		.wares li{
			padding:3%;
			height:40px;
		}
		.wares li p{
			float:left;
		}
		.wares li .wares_rig{
			width:20%;
			float:right;
		}
		
		.wares_rig span{
			margin-right:5%;
		}
		.red{
			color:red;
		}
		/* 价钱结算 */
		.money{
			width:100%;
			position: relative;
			background:white;
			padding:5%;
			height:100px;
			margin-bottom:2%;
		}
		.money .money_rig{
			float:right;
			color:red;
		}
		
		.money p{
			position: absolute;
			float:right;
			right:7%; 
			font-size:20px;
			margin-top:5%;
			color:red;
			/* padding:5%; */
		}
		/* 订单备注 */
		.remarks{
			background:white;
			height:90px;
			margin-bottom:2%;
		}
		.remarks li{
			width:100%;
			height:45px;
			line-height: 45px;
			padding:0 2%;
			border-bottom:1px solid #F5F5F5;
			position: relative;
		}
		.remarks li span.pay{
			/* float:right; */
			/* width:90px; */
			position: absolute;
			right:8%;
			color:#aaa;
			font-size:14px;
		}
		.remarks li img{
			width:7%;
			position: absolute;
			right:0;
			top:20%;
		}
		/* 固定待支付 */
		.wait_pay{
			width:100%;
			height:50px;
			
			position: fixed;
			bottom:0;
			z-index:999;
		}
		.wait_pay .left{
			width:70%;
			height:50px;
			float:left;
			background:#3C3C3C;
			font-size:20px;
			line-height:50px;
			color:white;
		}
		.wait_pay .left i{
			margin-left:5%;
			font-style:normal;
		}
		.wait_pay .rig{
			background:#56D176;
			width:30%;
			height:50px;
			float:right;
			font-size:20px;
			line-height:50px;
			color:white;
			text-align: center;
		}
   </style>
</head>
<body>

	<nav class="mui-bar mui-bar-tab">
	    <a class="mui-tab-item mui-active tab">
	        <span class="mui-icon mui-icon-map"></span>
	        <span class="mui-tab-label">外卖</span>
	    </a>
	    <a class="mui-tab-item tab">
	        <span class="mui-icon mui-icon-search"></span>
	        <span class="mui-tab-label">搜索</span>
	    </a>
	    <a class="mui-tab-item tab">
	        <span class="mui-icon mui-icon-settings"></span>
	        <span class="mui-tab-label">订单</span>
	    </a>
	    <a class="mui-tab-item tab">
	        <span class="mui-icon mui-icon-person"></span>
	        <span class="mui-tab-label">我的</span>
	    </a>
	</nav>
	<div class="mui-content">
	    <div class="content mui-active">
			<div class="ding1">
				<img src="img/ss.png" alt="" style="width:7%;position: absolute;top:20%;left:5%">
				<p class="cp1" id="dizhi"></p>
				<p class="cp2">
					<span>注册</span>|
					<span>登录</span>
				</p>
			</div>
			内容
		</div>
		<div class="content" style="display:none;">
			<div class="ding1">
				<img src="img/f.png" alt="" style="width:7%;position: absolute;top:20%;left:5%">
				<p class="cp1" style="left:45%">搜索</p>
			</div>
			<!-- 搜索框 -->
			<div class="search_box">
				<input type="text" placeholder="请输入商家或美食名称" class="search" id="inp" style="margin-bottom:0px;">
				<button id="btn">提交</button>
			</div>
			<!-- 商家 -->
			<div class="business">
				<h4>商家</h4>
				<ul class="business_list">
					<!-- 商家信息 -->
					<!-- <li> -->
						<!-- 商品图片 -->
						<!-- <div class="goodsimg">
							<img src="img/01.jpg" alt="">
						</div> -->
						<!-- 商品介绍 -->
						<!-- <div class="goods_intro">
							<span>炸鸡烤肉饭</span><br>
							<span>月售 72 单</span><br>
							<span>20元起送 / 距离271.5公里</span><br>
						</div> -->
					<!-- </li> -->
					<!-- <li> -->
						<!-- 商品图片 -->
						<!-- <div class="goodsimg">
							<img src="img/01.jpg" alt="">
						</div> -->
						<!-- 商品介绍 -->
						<!-- <div class="goods_intro">
							<span>炸鸡烤肉饭</span><br>
							<span>月售 72 单</span><br>
							<span>20元起送 / 距离271.5公里</span><br>
						</div> -->
					<!-- </li> -->
				</ul>
			</div>
			<!-- 搜索历史 -->
			<div class="search_history">
				<h4>搜索历史</h4>
				<ul class="history_list" id="keyname">
					
				</ul>
			</div>
		</div>
		<div class="content" style="display:none;">
			<div class="ding1">
				<img src="img/f.png" alt="" style="width:7%;position: absolute;top:20%;left:5%">
				<p class="cp1" style="left:40%">订单列表</p>
				<!-- 选取地址 -->
				<div class="address">
					<div class="select_add">
						<img src="img/dizhi.svg" alt="">
						<span>请添加一个收货地址</span>
						<img src="img/you.svg" alt="" class="add2">
					</div>
				</div>
				<!-- 送达时间 -->
				<div class="Service_time">
					<div class="time">
						<!-- 左 -->
						<div class="time_left">
							<b>送达时间</b>
						</div>
						<!-- 右 -->
						<div class="time_rig">
							<p class="p1">
								尽快送达 | 预计 06:32
							</p>
							<p class="p2">
								蜂鸟专送
							</p>
						</div>
					</div>
				</div>
				<!-- 支付方式 -->
				<ul class="payment">
				    <li class="">
						<span>
							支付方式
						</span>
						<span class="pay">
							在线支付
							
						</span>
						<img src="img/you.svg" alt="">
						
				    </li>
					<li class="">
						<span style="font-size:14px;color:#BDAAB2;">
							红包
						</span>
						<span class="pay" style="font-size:14px;color:#BDAAB2;">
							暂时只在饿了么 APP 中支持
						</span>
					</li>
				</ul>
				<!-- 订单商户商品 -->
				<div class="business">
					<img src="img/02.jpg" alt="">
					<span>效果演示</span>
				</div>
				<!-- 商品列表 -->
				<ul class="wares">
					<li>
						<p>奶茶三兄弟</p>
						<div class="wares_rig">
							<span class="red">x1</span>
							<span>￥20</span>
						</div>
					</li>
					<li>
						<p>奶茶三兄弟</p>
						<div class="wares_rig">
							<span class="red">x1</span>
							<span>￥20</span>
						</div>
					</li>
					<li>
						<p>奶茶三兄弟</p>
						<div class="wares_rig">
							<span class="red">x1</span>
							<span>￥20</span>
						</div>
					</li>
				</ul>
				<!-- 价钱结算 -->
				<div class="money">
					<span>
						订单￥60
					</span>
					<span class="money_rig">
						待支付
					</span>
					<p>￥60</p>
				</div>
				<!-- 订单备注 -->
				<ul class="remarks">
				    <li class="">
						<span>
							订单备注
						</span>
						<span class="pay">
							口味偏好等
						</span>
						<img src="img/you.svg" alt="">
				    </li>
					<li class="">
						<span>
							发票抬头
						</span>
						<span class="pay">
							不需要开发票
						</span>
						<img src="img/you.svg" alt="">
					</li>
				</ul>
				<!-- 固定待支付 -->
				<div class="wait_pay">
					<p class="left"><i>待支付￥60</i></p>
					<p class="rig">确认下单</p>
				</div>
			</div>
			内容
		</div>
		<div class="content" style="display:none;">
			<div class="ding1">
				<img src="img/f.png" alt="" style="width:7%;position: absolute;top:20%;left:5%">
				<p class="cp1" style="left:45%">我的</p>
			</div>
			内容
		</div>
	</div>
</body>
	<script src="js/mui.min.js"></script>
	<script src="js/jquery-1.12.3.min.js"></script>
	<script src="js/zepto.js"></script>
	<script src="js/ajax.js"></script>
	<script type="text/javascript" charset="utf-8">
	  	mui.init();
	</script>
	<script>
		var tab = document.getElementsByClassName("tab");
		var content = document.getElementsByClassName("content");
		for(var i = 0; i < tab.length;i++){
			tab[i].index = i;
			tab[i].addEventListener("tap",function(){
				for(var j = 0 ; j < content.length;j++){
					content[j].style.display = "none";
				}
				content[this.index].style.display = "block";
			});
		}
		var id = window.location.search;
		var zhuanhuan =	decodeURIComponent(id);
		var jiequ=zhuanhuan.indexOf("?");
		var dizhi = zhuanhuan.substr(1);
		console.log(dizhi);
		$("#dizhi").html(dizhi);
	</script>
	<!-- 搜索历史hmr -->
	<script>
		var searchArr;
		//定义一个search的，判断浏览器有无数据存储（搜索历史）
		if(localStorage.search){
			//如果有，转换成 数组的形式存放到searchArr的数组里（localStorage以字符串的形式存储，所以要把它转换成数组的形式）
			searchArr= localStorage.search.split(",")
		}else{
			//如果没有，则定义searchArr为一个空的数组
			searchArr = [];
		}
		//把存储的数据显示出来作为搜索历史
		MapSearchArr();
			
		$("#btn").on("click", function(){
			var moment = $(".search").val();
			console.log(moment);
			$.ajax({
				url:"https://elm.cangdu.org/v4/restaurants?geohash=31.22967,121.4762&keyword="+moment,
				type:'get',
				dataType:'json',
				success:function(data){
					console.log(data);
					var str = '';
					for(var i = 0; i < data.length; i++){
						str+='<li><div class="goodsimg"><img src="img/01.jpg" alt=""></div><div class="goods_intro"><span>'+data[i].name+'</span><br><span>月售 '+data[i].recent_order_num+' 单</span><br><span>20元起送 / 距离271.5公里</span><br></div></li>'
					}
					$('.business_list').html(str);
				},
				error:function(data){
					console.log(data);
				}
			})
			var val = $("#inp").val();
			//点击搜索按钮时，去重
			KillRepeat(val);
			//去重后把数组存储到浏览器localStorage
			localStorage.search = searchArr;
			//然后再把搜索内容显示出来
			MapSearchArr();
		});
		function MapSearchArr(){
			$('#keyname').html('');
			for (var i=0;i<searchArr.length;i++){
				$("<li class='li'>" + searchArr[i] + "<b class='x'>x</b></li>").appendTo($("#keyname"));
				// $("<i class='x'>x</i>").appendTo($("#keyname"));
				
			}
			$("<li class='emptylishi'>清空搜索历史</li>").appendTo($("#keyname"));
			// 删除单个历史记录
			$("b.x").click(function(){
				$(this).parent().remove();
			})
			// 清除全部
			$("#keyname .emptylishi").click(function(){
				 $("#keyname .li").remove();
			});
		}
		
		
		//去重
		function KillRepeat(val){
			var kill = 0;
			for (var i=0;i<searchArr.length;i++){
				if(val===searchArr[i]){
					kill ++;
				}
			}
			if(kill<1){
				searchArr.push(val);
			}
		}
	</script>
</html>